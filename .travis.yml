language: node_js
node_js:
- '8'
dist: trusty
services:
- mongodb
- redis-server
env:
  matrix:
  - NODE_ENV=ci PORT=3000
  global:
  - secure: JqbUNKasukEsjJlqWUyYsGeRHSVwVyYo09PintKEzbWX2eEySJbQ0+gakLE2yMlVM+e+oabeh81YjpExFJb/pv7OObQZFC7gBvMCdJJ2qzN/Eu179IvsHHLmygE30m65op5nZOe40nJJwqZFzVSmTCsGRj/8wYYTE/5o1QSHUv3Q3+9iosg44D1sRkt7DXPHT+3EfPuqHpH6JBmza9yDszu/QVOKYYyj8Q2beogOQlq49nkiDe2VN5St4iG6+w5ONWCWjR/D3E94irY1e5cP+4oq/Z32rJRclezZXUJcbYAHakSlhrEZ5AN5i3JallJLLV1ktKEtIG3pS3QTcyCeCMQmKPYexoujdlDPCIOMrY4E/748iW4wETODA4Nn8ibWxjgOmB4zso/PVtWJbthEqI+Jl6Qzhh3o8aR37L50rn0AUBqDwkFZ8wUD0taJ0wKLFrEaFTA7dywOibtuhsj6LnUzgp0f+yNJcQ/xXrBe/+VcPHM/UF7DCC4CM+2vPlF1b89M3YcmwBzW3sHywh4XEjpzYyHMrTWLTR+pbfszIggl39EJt3h5KSfx7jItK4+SyXq9OgIi+Nc4fhZyXP0n8401A6UvTY2SresKVo2y9yNGdZVjDYZS9sORy0jThd7ug/TQh+dFaez0m7c1mROfm7w/UnkG1Dej8EIAAUPh3Og=
  - secure: RHHdavZGV/U1wzF5Nd2RLOAsbFFSKBeZKN6dEs3l09fpViC1/kDtUABBYObfiYxTIsI8EFWK7cRhOrx7JmFlohc/y5yBpWVmmbZnH5HjN2fJjgHlJvwHbJVjjQnf2GQZUdaiNKkOl5HblGmkQ+8+qa1Y4AzyooJfYx088wzJNZbzINz5Ovpo4caD6QRxgy2nZmCkAfBwjtCJy0BrtEeo4JCdsf9Rah65w3uuYawJ5MnqHxOI0cay4NhSV+kaEwqcccC5KKAjfP4AqZaKNv0LG/f0VwuJvhRm9Qf09JbVK7VZcXJS7zfO1T5ZdXtArdLh6q4sa6xoe9z5YVj4WJEUKVd1QRk958LmMu6r8R56BkQ8u1Vfckn/RDAfiie0J9JZEhgmlbLKad5QiNZ0JF4koflvpudTSdWDyDhSrHhkfTblU8w4GxlIrn7ZulKC0A4dmax0XfEiqPECXo5OoWEwB65w3KSVKNhHExL5GvyPzPJopI4Q/RGFdpXk8lC7bpa73i7dUs5/QtJzqg8++a2li4gIXr6sAhcf8jHYxu1M/9j4PrdX0xDvlAiAvOc+dieO1cvjNFgEK55yo3aAsgKyaaPzMZT2kdUbG/mqSBjkrvjgN3GNGXq8Z0BldTgvCO1gx9Nhjbh+o+0yKd4J08AbmSVGz9niX0wKvGuM1Fka3Nk=
  - secure: FJTpj/xG4WqZVKmHZaNC7UNwY8RH77Nd6gUrd3yEEizKBE2zTc/LHAZWA5swFLgoUVzYqW3M9s975naIu6Y7wbCFwO4vYOwdDr7vtG1AKdFJS8ecDdldBwuMAu0sAEbigwc0uHd7fnQ5KukFvNWq3hg1ikCS7JSrEMoh4iErLSAkwdY44foi+QQ/lIc5sU6JRF3dznpEL8RoZHCJgZoqnqxCl8Nig5Y2DLyOc+Y9odN1JSvi6hghYYSm1yDjSQDTbTWpaIntsuH0HnyTY1l+A/QYZGgKnamkwYJzc81BpyqhdYLNL0GFZOKi19VBzQpx5UHQTULDZxIK7EkM1m2kcfpytMKMZTtHoctav9z5hhrVcqcs20Ed/8/N7laqzrkUyd26tYyzWpb40HMB5Ey6jKDzm6az53RaBkmqgKyU5/t0OIaym2/nf6EJGwrnMa3nKRpL5XJC3eDc2H/04vn4bumCeGw0rQfQ2IT5EMa+T1hevGDvvC7czDT1xN9YQ4pliogwMPhUgNnJOhWXcVBGNqM2SGxr3VSheP7vuR7aKq8oFBDza5nFa4+Xyh8eaaPEO+oF9BtE302DAPc17THhhw4rPa0RnoyAi24wEvdX/q5gzYkIIxeSlHR6qiA6i1OUNyoKOe2ILB9NguOnG8tHmLKIjn7ueY8PRcsRYJ83v2g=
  - secure: GQR5JIoEjXNvzvB/2FRn5FmZb7U7QL4LkALdQ4fxpkfR88+brGALgxqx7lj9QJfuQsryqrd4O0UiFDIpZBfNRUgAheZkyiqIl5LO/DytdCB36LDjDS7qKfqGRleWtv+xfZEMCb6bjHB1B5sshjLsPqW6CsFt/zFXw+zbHxj8Ro1sA4GaBJKK+bCNiHzMvZgEMDrAcj6t7a6KK6L3QQGBuwfObM8Heh5v8Br7Vbnumo2QLjYQqPXf/8W7AuQg0T0FefdUUlP/4DfKqtC6bEClnD7Eq95r4zxSpfN29OsXvCTPZrds2T1Pw4PMgU9hETjEKdYXlup5Byj6NLSlpRaGiX0eKcgASRn+jk8tnlilZxgccMQnXorkLI38h5lKgSJr71ysuAPC6/lxAR1mWCtcolUaluZsFhfchaxusANLInfbCzEk9ug33uFqzauWM1tR/bZWlinUZzymEboPxf1cLw3HsRdlsMIePnX6h/WsTrqfPLzqyrmAP8A6RrVXFSCg2lCjKCiR2KSSumb05exgViDkxIFRcvb3+a3XSSX2DU9ddncmkjaVLFJEnhTdPs6Zno/1Hej+y5tKTx4f+BTDHEEAa9BeqRaW+JJWutn6+NzglqweocdAPVLCGMTsuUBuyNxXSwqLnuEuVylJuBAXPGBEQx8sUopL/FTMMgs+1KQ=
  - secure: Ij9AJSZtP8QF2b5/x35xeX590QSUVOt0iyXw2eNxQtO604n2+nDtCDnMFdBoTroSxJbUEYKYKr0iNVr4xVEqd6Jyqf2LKqLJt2xDCNbaylU0ZfcyxvUDNsJRM9gx0RMpbbSlUgOJpTJbYs9BNSqgfRZLu1ziDflaqroyecRU3t7mTIJgDL/bmWy3BzYbzxs1Gn0oj9ZgmK3zdYurXxzl/PyvicLxL5Ba8pNVstxPQsztR4Fkzim3AtdQo2YM6+aCpq23oZ7K96GAYD6fUHJo5mC9zpaQ+wtl/r8zRNyHC5PVjeJWllFvrPZEktWt26aYBiqfhp1trWfoRrL4WiKV+nC414JG40ogDmI/MArfE2hBBBmNEs4uOZtQzazXVYeeadqa9APFRxBfRrs0D+DoR5e7kxzdFTH4oIj6yerM1BHl+QxpiWlEYPD5uXNNfTghsfKQyrG/PCTCPD+t3bzxeA11IdzTth7RS05lrcR6drsdPPHyOnaYmvqNblQnJ7HhYYY8y80hmnuYdpbDaWrm6lcsnE5iDVSp4Yc5A8vwLBGtDo9UMgBAqmdW4OEd6Z8VoaX9dB16e/V/b6u3sqM1pD72QA4Zb8KVEvaOIZwiYFo2CLfCHjlxaQ83RxlzK4nr31Kcte1gnVyzhSfGwjuOHUlAINxJfTDwK4OKdVnX3s0=
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- echo "close" > .TEST-STATUS
- nohup npm run start &
- sleep 3
- npm run lint
- npm run test:ci
